{
  "catalog": {
    "schemas": [
      {
        "name": "public",
        "enums": [
          {
            "name": "genre",
            "values": [
              "comedy",
              "drama",
              "science fiction",
              "fantasy",
              "biography"
            ]
          }
        ],
        "records": [
          {
            "kind": "table",
            "name": "author",
            "columns": [
              {
                "name": "id",
                "type": {
                  "name": "uuid",
                  "display": "uuid",
                  "is_array": false,
                  "schema_name": "pg_catalog",
                  "is_composite": false,
                  "array_dimensions": 0
                },
                "default": "gen_random_uuid()",
                "is_unique": false,
                "is_nullable": false,
                "is_foreign_key": false,
                "is_primary_key": true,
                "foreign_table_name": null,
                "foreign_table_schema": null
              },
              {
                "name": "name",
                "type": {
                  "name": "text",
                  "display": "text",
                  "is_array": false,
                  "schema_name": "pg_catalog",
                  "is_composite": false,
                  "array_dimensions": 0
                },
                "default": null,
                "is_unique": false,
                "is_nullable": false,
                "is_foreign_key": false,
                "is_primary_key": false,
                "foreign_table_name": null,
                "foreign_table_schema": null
              },
              {
                "name": "birthday",
                "type": {
                  "name": "date",
                  "display": "date",
                  "is_array": false,
                  "schema_name": "pg_catalog",
                  "is_composite": false,
                  "array_dimensions": 0
                },
                "default": null,
                "is_unique": false,
                "is_nullable": true,
                "is_foreign_key": false,
                "is_primary_key": false,
                "foreign_table_name": null,
                "foreign_table_schema": null
              }
            ]
          },
          {
            "kind": "table",
            "name": "book",
            "columns": [
              {
                "name": "id",
                "type": {
                  "name": "uuid",
                  "display": "uuid",
                  "is_array": false,
                  "schema_name": "pg_catalog",
                  "is_composite": false,
                  "array_dimensions": 0
                },
                "default": "gen_random_uuid()",
                "is_unique": false,
                "is_nullable": false,
                "is_foreign_key": false,
                "is_primary_key": true,
                "foreign_table_name": null,
                "foreign_table_schema": null
              },
              {
                "name": "title",
                "type": {
                  "name": "text",
                  "display": "text",
                  "is_array": false,
                  "schema_name": "pg_catalog",
                  "is_composite": false,
                  "array_dimensions": 0
                },
                "default": null,
                "is_unique": false,
                "is_nullable": false,
                "is_foreign_key": false,
                "is_primary_key": false,
                "foreign_table_name": null,
                "foreign_table_schema": null
              },
              {
                "name": "author_id",
                "type": {
                  "name": "uuid",
                  "display": "uuid",
                  "is_array": false,
                  "schema_name": "pg_catalog",
                  "is_composite": false,
                  "array_dimensions": 0
                },
                "default": null,
                "is_unique": false,
                "is_nullable": false,
                "is_foreign_key": true,
                "is_primary_key": false,
                "foreign_table_name": "author",
                "foreign_table_schema": "public"
              },
              {
                "name": "year",
                "type": {
                  "name": "int4",
                  "display": "integer",
                  "is_array": false,
                  "schema_name": "pg_catalog",
                  "is_composite": false,
                  "array_dimensions": 0
                },
                "default": null,
                "is_unique": false,
                "is_nullable": false,
                "is_foreign_key": false,
                "is_primary_key": false,
                "foreign_table_name": null,
                "foreign_table_schema": null
              },
              {
                "name": "isbn",
                "type": {
                  "name": "text",
                  "display": "text",
                  "is_array": false,
                  "schema_name": "pg_catalog",
                  "is_composite": false,
                  "array_dimensions": 0
                },
                "default": null,
                "is_unique": true,
                "is_nullable": false,
                "is_foreign_key": false,
                "is_primary_key": false,
                "foreign_table_name": null,
                "foreign_table_schema": null
              },
              {
                "name": "is_best_seller",
                "type": {
                  "name": "bool",
                  "display": "boolean",
                  "is_array": false,
                  "schema_name": "pg_catalog",
                  "is_composite": false,
                  "array_dimensions": 0
                },
                "default": "false",
                "is_unique": false,
                "is_nullable": true,
                "is_foreign_key": false,
                "is_primary_key": false,
                "foreign_table_name": null,
                "foreign_table_schema": null
              },
              {
                "name": "genre",
                "type": {
                  "name": "text",
                  "display": "text",
                  "is_array": false,
                  "schema_name": "pg_catalog",
                  "is_composite": false,
                  "array_dimensions": 0
                },
                "default": null,
                "is_unique": false,
                "is_nullable": false,
                "is_foreign_key": true,
                "is_primary_key": false,
                "foreign_table_name": "genre",
                "foreign_table_schema": "public"
              }
            ]
          }
        ]
      }
    ]
  },
  "queries": [
    {
      "query": "insert into author (\n    id, name, birthday\n) values (\n    $1, $2, $3\n) on conflict (id)\ndo update set\n    id = $1,\n    name = $2,\n    birthday = $3\nreturning author;",
      "name": "upsert",
      "command": "one",
      "path": "author.sql",
      "annotations": {
        "name": { "value": "upsert :one", "line": 2 },
        "not_null_result": { "value": "", "line": 3 }
      },
      "output": [
        {
          "name": "author",
          "type": { "schema": "public", "name": "author", "id": 16386 }
        }
      ],
      "parameters": [
        {
          "name": "author.id",
          "not_null": true,
          "type": { "schema": "pg_catalog", "name": "uuid", "id": 2950 }
        },
        {
          "name": "author.name",
          "not_null": true,
          "type": { "schema": "pg_catalog", "name": "text", "id": 25 }
        },
        {
          "name": "author.birthday",
          "not_null": true,
          "type": { "schema": "pg_catalog", "name": "date", "id": 1082 }
        }
      ]
    },
    {
      "query": "select author from author where id = $1::uuid;",
      "name": "get_by_id",
      "command": "one",
      "path": "author.sql",
      "annotations": { "name": { "value": "get_by_id :one", "line": 15 } },
      "output": [
        {
          "name": "author",
          "type": { "schema": "public", "name": "author", "id": 16386 }
        }
      ],
      "parameters": [
        {
          "name": "id",
          "not_null": true,
          "type": { "schema": "pg_catalog", "name": "uuid", "id": 2950 }
        }
      ]
    },
    {
      "query": "select author, array_agg(book) as books\nfrom author\njoin book on author.id = book.author_id\ngroup by author.id;",
      "name": "get_all_with_books",
      "command": "many",
      "path": "author.sql",
      "annotations": {
        "name": { "value": "get_all_with_books :many", "line": 18 }
      },
      "output": [
        {
          "name": "author",
          "type": { "schema": "public", "name": "author", "id": 16386 }
        },
        {
          "name": "books",
          "type": { "schema": "public", "name": "_book", "id": 16400 }
        }
      ],
      "parameters": []
    },
    {
      "query": "select count(*) from author;",
      "name": "count",
      "command": "val",
      "path": "author.sql",
      "annotations": { "name": { "value": "count :val", "line": 24 } },
      "output": [
        {
          "name": "count",
          "type": { "schema": "pg_catalog", "name": "int8", "id": 20 }
        }
      ],
      "parameters": []
    },
    {
      "query": "select book from book where id = $1;",
      "name": "get_by_id",
      "command": "one",
      "path": "author.sql",
      "annotations": {
        "name": { "value": "get_by_id :one", "line": 28 },
        "namespace": { "value": "book", "line": 29 }
      },
      "output": [
        {
          "name": "book",
          "type": { "schema": "public", "name": "book", "id": 16401 }
        }
      ],
      "parameters": [
        {
          "name": "id",
          "not_null": true,
          "type": { "schema": "pg_catalog", "name": "uuid", "id": 2950 }
        }
      ]
    }
  ],
  "config": {
    "version": "1",
    "queries": ["book.sql", "author.sql", "queries.sql"],
    "disable_cache": false,
    "database": { "migrations": ["schema.sql"] },
    "codegen": {
      "out": "./queries",
      "language": "python",
      "driver": "psycopg",
      "types": { "pg_catalog.uuid": { "annotation": "str" } },
      "options": { "package": "queries" },
      "enums": ["genre"]
    }
  }
}
